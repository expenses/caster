(window.webpackJsonpCaster=window.webpackJsonpCaster||[]).push([[0],{282:function(e,t,a){e.exports=a(638)},319:function(e,t){},321:function(e,t){},348:function(e,t){},350:function(e,t){},571:function(e,t){},635:function(e,t,a){},636:function(e,t,a){},638:function(e,t,a){"use strict";a.r(t);var n=a(10),s=a(11),r=a(13),i=a(12),c=a(14),l=a(0),o=a.n(l),u=a(175),d=a.n(u),p=a(121),h=a(19),m=a.n(h),f=a(66),g=a(16),v=a(49),y=a.n(v),b=a(639),k=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.feed;return o.a.createElement("div",{className:"browser-item",onClick:this.props.onClick},o.a.createElement("img",{src:e.meta.imageURL,alt:""}),o.a.createElement("div",{className:"feed-description"},o.a.createElement("div",null,o.a.createElement("h2",null,e.meta.title),o.a.createElement("p",null,e.meta.description),o.a.createElement("p",null,e.episodes.length," episodes"),o.a.createElement("p",null,"Last refreshed ",y()(this.props.time).fromNow()),o.a.createElement("p",null,"Latest episode was ",y()(e.episodes[0].pubDate).fromNow())),o.a.createElement(b.a,{className:"x-button",onClick:this.delete.bind(this)})))}},{key:"delete",value:function(e){e.stopPropagation(),this.props.delete()}}]),t}(l.Component),O=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.episode;return o.a.createElement("div",{className:"browser-item",onClick:this.props.play},o.a.createElement("img",{src:e.imageURL||this.props.backupImage,alt:""}),o.a.createElement("div",{className:"episode-description"},o.a.createElement("h2",null,e.title),o.a.createElement("p",null,y()(e.pubDate).format("L LT"))))}}]),t}(l.Component),E=a(640),j=a(641),S=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).state={entered:e.defaultValue||""},a.handleKey=a.handleKey.bind(Object(g.a)(a)),a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("input",{type:"text",value:this.state.entered,className:this.props.className,onChange:function(t){return e.setState({entered:t.target.value})},onKeyDown:this.handleKey,placeholder:this.props.placeholder,ref:function(t){return e.input=t}})}},{key:"handleKey",value:function(e){if(e.stopPropagation(),"Enter"===e.key){var t=this.state.entered;t&&(this.setState({entered:""}),this.props.callback(t),this.props.returnFocus.focus())}}}]),t}(l.Component),w=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return this.props.search?o.a.createElement("div",{className:"browser-input"},o.a.createElement(E.a,null),o.a.createElement("input",{placeholder:"Search",onChange:function(t){return e.props.onChange(t.target.value)},onKeyDown:function(e){return e.stopPropagation()},value:this.props.searchTerm})):o.a.createElement("div",{className:"browser-input"},o.a.createElement(j.a,null),o.a.createElement(S,{placeholder:"Add feed url",callback:this.props.addFeed,returnFocus:this.props.returnFocus}))}}]),t}(l.Component),C=a(278),F=a.n(C),T=a(642),N=a(643),U=a(644),x=a(645),P=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).state={selected:null,search:!1,searchTerm:""},a.toHome=a.toHome.bind(Object(g.a)(a)),a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"titlebar"},o.a.createElement("div",{className:"titlebar-left"},o.a.createElement(T.a,{onClick:this.props.logout}),o.a.createElement(N.a,{onClick:this.props.settings,style:this.style(this.props.settingsOpen)}),o.a.createElement(U.a,{onClick:this.toHome,style:this.style(!this.state.selected&&!this.state.search&&!this.props.settingsOpen)}),o.a.createElement(E.a,{onClick:function(){return e.setState({search:!0})},style:this.style(this.state.search&&!this.props.settingsOpen)}),o.a.createElement("h1",null,this.title())),o.a.createElement(x.a,{onClick:this.props.refresh})),o.a.createElement("div",{className:"browser"},o.a.createElement("div",{className:"browser-content"},this.inner()),o.a.createElement(w,{searchTerm:this.state.searchTerm,onChange:function(t){return e.setState({searchTerm:t})},search:this.state.search,addFeed:this.props.addFeed,returnFocus:this.props.returnFocus})))}},{key:"title",value:function(){return this.state.search?"Search episodes":this.state.selected?this.props.feeds[this.state.selected].data.meta.title:"Podcasts"}},{key:"inner",value:function(){var e=this,t=this.props.feeds,a=this.state.selected;if(this.state.search&&!this.state.searchTerm)return o.a.createElement("h1",{className:"center"},"No search term entered");if(this.state.search){var n=Object.keys(t).flatMap(function(e){return t[e].data.episodes.map(function(t){return{episode:t,url:e,episode_title:t.title,episode_description:t.description}})});return F.a.go(this.state.searchTerm,n,{limit:50,keys:["episode_title","episode_description"],threshold:-500}).map(function(t){return e.episode(t.obj.episode,t.obj.url)})}return a?t[a].data.episodes.map(function(t){return e.episode(t,a)}):Object.keys(t).map(function(a){return o.a.createElement(k,{key:a,feed:t[a].data,time:t[a].time,delete:function(){return e.props.deleteUrl(a)},onClick:function(){return e.setState({selected:a})}})})}},{key:"episode",value:function(e,t){var a=this;return o.a.createElement(O,{episode:e,key:e.guid,backupImage:this.props.feeds[t].data.meta.imageURL,play:function(){return a.props.play(e,t)}})}},{key:"style",value:function(e){return e?{color:"white"}:null}},{key:"toHome",value:function(){this.setState({selected:null,search:!1})}}]),t}(l.Component),I=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.playing,a=this.props.tags;return o.a.createElement("div",{className:"playing-info"},o.a.createElement("h1",null,(null===t||void 0===t?void 0:t.episode.title)||"No Episode Selected"),o.a.createElement("h2",null,null===t||void 0===t?void 0:t.feed.meta.title),o.a.createElement("p",{dangerouslySetInnerHTML:{__html:null===t||void 0===t?void 0:t.episode.description}}),t?o.a.createElement("h2",null,"Tags:"):null,o.a.createElement("div",{className:"tags"},a.map(function(t,a){return o.a.createElement("div",{key:a,className:"tag",onClick:function(){return e.props.seek(t.time)}},o.a.createElement("p",null,t.text),o.a.createElement(b.a,{size:"12px",onClick:function(){return e.props.deleteTag(a)}}))})))}}]),t}(l.Component),L=a(279),D=a.n(L),K=a(646),R=a(647),B=a(648),A=a(649),M=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).state={time:0,playing:!1},a.seek=a.seek.bind(Object(g.a)(a)),a.seekBackwards=a.seekBackwards.bind(Object(g.a)(a)),a.seekForwards=a.seekForwards.bind(Object(g.a)(a)),a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t=this,a=null===(e=this.player)||void 0===e?void 0:e.audioEl;return o.a.createElement("div",{className:"player"},o.a.createElement(K.a,{onClick:this.seekBackwards}),this.state.playing?o.a.createElement(R.a,{onClick:function(){return null===a||void 0===a?void 0:a.pause()}}):o.a.createElement(B.a,{onClick:function(){return null===a||void 0===a?void 0:a.play()}}),o.a.createElement(A.a,{onClick:this.seekForwards}),o.a.createElement("p",null,_(this.state.time)),o.a.createElement("input",{className:"player-bar",type:"range",min:"0",value:(null===a||void 0===a?void 0:a.currentTime)||0,max:(null===a||void 0===a?void 0:a.duration)||0,step:"any",onChange:function(e){return t.seek(e.target.value)}}),o.a.createElement("p",null,(null===a||void 0===a?void 0:a.duration)?_(a.duration):"--:--:--"),o.a.createElement(D.a,{autoPlay:!0,src:this.props.url,ref:function(e){return t.player=e},onPlay:function(){return t.setState({playing:!0})},onPause:function(){return t.setState({playing:!1})},listenInterval:100,onListen:function(e){return t.setState({time:e})}}))}},{key:"time",value:function(){var e;return(null===(e=this.player)||void 0===e?void 0:e.audioEl.currentTime)||0}},{key:"seek",value:function(e){var t=this.player.audioEl;t.src&&(t.currentTime=e,this.setState({time:e}))}},{key:"seekBackwards",value:function(){this.seek(this.player.audioEl.currentTime-this.props.settings.seekAmount)}},{key:"seekForwards",value:function(){this.seek(this.player.audioEl.currentTime+this.props.settings.seekAmount)}},{key:"toggle",value:function(){var e=this.player.audioEl;e.src&&(this.state.playing?e.pause():e.play())}}]),t}(l.Component);function _(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=Math.floor(e%60);return t<10&&(t="0"+t),a<10&&(a="0"+a),n<10&&(n="0"+n),"".concat(t,":").concat(a,":").concat(n)}var H=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.playing,t=(null===e||void 0===e?void 0:e.episode.imageURL)||(null===e||void 0===e?void 0:e.feed.meta.imageURL);return o.a.createElement("div",{className:"playing-image"},t?o.a.createElement("img",{src:t,alt:""}):null)}}]),t}(l.Component),J=a(280),$=a.n(J),V=a(650),z=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.settings;return o.a.createElement($.a,{className:"settings-modal",overlayClassName:"settings-modal-overlay",isOpen:this.props.open,appElement:document.getElementById("root")},o.a.createElement("div",{className:"settings-title"},o.a.createElement(V.a,{onClick:this.props.close}),o.a.createElement("h2",null,"Settings")),o.a.createElement("div",{className:"settings-content"},o.a.createElement("p",null,"CORS Proxy Url:"),o.a.createElement(S,{defaultValue:e.corsProxy}),o.a.createElement("h3",null,"Key Bindings"),o.a.createElement("p",null,"Play/Pause"),o.a.createElement(S,{defaultValue:e.toggle})))}}]),t}(l.Component),q=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"tag-entry"},o.a.createElement("div",{className:"tag-entry-inner"},o.a.createElement(j.a,null),o.a.createElement(S,{placeholder:"Enter Tag",callback:this.props.addTag,ref:function(t){return e.input=t},returnFocus:this.props.dashboard})))}},{key:"focus",value:function(){this.input.focus()}}]),t}(l.Component),G=a(281),Q={fields:{meta:["title","description","imageURL"],episodes:["title","description","imageURL","pubDate","enclosure","duration","guid"]}};function W(e,t){return X.apply(this,arguments)}function X(){return(X=Object(f.a)(m.a.mark(function e(t,a){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",G.getPodcastFromURL("".concat(t,"/").concat(a),Q));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Y(e,t,a){e.putFile(t,JSON.stringify(a),{})}function Z(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(f.a)(m.a.mark(function e(t,a){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getFile(a,{}).then(function(e){return JSON.parse(e)||{}}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}var te=a(67),ae=a.n(te),ne=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(r.a)(this,Object(i.a)(t).call(this,e))).state={feeds:{},tags:{},settings:{corsProxy:"https://caster-cors-proxy.herokuapp.com",toggle:"p",seekBackwards:",",seekForwards:".",enterTag:"t",seekAmount:5},playing:null,settingsOpen:!1,message:""},a.addFeed=a.addFeed.bind(Object(g.a)(a)),a.clearFeeds=a.clearFeeds.bind(Object(g.a)(a)),a.playAudio=a.playAudio.bind(Object(g.a)(a)),a.deleteUrl=a.deleteUrl.bind(Object(g.a)(a)),a.addTag=a.addTag.bind(Object(g.a)(a)),a.refresh=a.refresh.bind(Object(g.a)(a)),a.deleteTag=a.deleteTag.bind(Object(g.a)(a)),a.handleKey=a.handleKey.bind(Object(g.a)(a)),a.saveFeeds=a.saveFeeds.bind(Object(g.a)(a)),a}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state.feeds,a=this.state.playing;return o.a.createElement("div",{className:"dashboard",ref:function(t){return e.dashboard=t},onKeyDown:this.handleKey,tabIndex:"0"},o.a.createElement(z,{open:this.state.settingsOpen,settings:this.state.settings,close:function(){return e.setState({settingsOpen:!1})}}),o.a.createElement(P,{feeds:t,deleteUrl:this.deleteUrl,play:this.playAudio,refresh:this.refresh,addFeed:function(t){return e.addFeed(t).then(e.saveFeeds)},returnFocus:this.dashboard,settings:function(){return e.setState({settingsOpen:!0})},logout:this.props.handleSignOut,settingsOpen:this.state.settingsOpen}),o.a.createElement(H,{playing:a}),o.a.createElement(M,{url:null===a||void 0===a?void 0:a.episode.enclosure.url,setTime:function(t){return e.setState({time:t})},ref:function(t){return e.player=t},settings:this.state.settings}),o.a.createElement(I,{playing:a,tags:this.getTags(),seek:function(t){var a;return null===(a=e.player)||void 0===a?void 0:a.seek(t)},addTag:this.addTag,deleteTag:this.deleteTag,dashboard:this.dashboard}),o.a.createElement(q,{callback:this.addTag,ref:function(t){return e.tagentry=t},returnFocus:this.dashboard}))}},{key:"handleKey",value:function(e){e.preventDefault();var t=this.state.settings;e.key===t.toggle&&this.player.toggle(),e.key===t.seekBackwards&&this.player.seekBackwards(),e.key===t.seekForwards&&this.player.seekForwards(),e.key===t.enterTag&&this.tagentry.input.focus()}},{key:"refresh",value:function(){var e=Object(f.a)(m.a.mark(function e(){return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.keys(this.state.feeds).map(this.addFeed));case 2:this.saveFeeds();case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"playingString",value:function(){var e=this.state.playing;if(e){var t=e.feedUrl,a=e.episode.guid;return"".concat(t,":").concat(a)}return""}},{key:"getTags",value:function(){var e=this.state.tags,t=this.playingString();return t&&t in e?e[t]:[]}},{key:"deleteTag",value:function(e){var t=this.playingString();if(t){var a=ae()(this.state.tags,Object(p.a)({},t,{$splice:[[e,1]]}));this.setState({tags:a},this.saveTags)}}},{key:"addTag",value:function(e){var t=this,a=this.playingString();if(a){var n=ae()(this.state.tags,Object(p.a)({},a,function(a){return ae()(a||[],{$push:[{text:e,time:t.player.time()}]})}));this.setState({tags:n},this.saveTags)}}},{key:"deleteUrl",value:function(e){var t=ae()(this.state.feeds,{$unset:[e]});this.setState({feeds:t},this.saveFeeds)}},{key:"playAudio",value:function(e,t){this.setState({playing:{episode:e,feed:this.state.feeds[t].data,feedUrl:t}})}},{key:"clearFeeds",value:function(){this.setState({feeds:{}},this.saveFeeds)}},{key:"addFeed",value:function(){var e=Object(f.a)(m.a.mark(function e(t){var a=this;return m.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",W(this.state.settings.corsProxy,t).then(function(e){var n=ae()(a.state.feeds,{$merge:Object(p.a)({},t,{time:Date.now(),data:e})});return a.setState({feeds:n})}));case 1:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveFeeds",value:function(){Y(this.props.userSession,"feeds.json",this.state.feeds)}},{key:"saveTags",value:function(){Y(this.props.userSession,"tags.json",this.state.tags)}},{key:"componentDidMount",value:function(){var e=this;Z(this.props.userSession,"feeds.json").then(function(t){return e.setState({feeds:t})}),Z(this.props.userSession,"tags.json").then(function(t){return e.setState({tags:t})})}}]),t}(l.Component),se=a(651),re=a(652),ie=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.handleSignIn;return o.a.createElement("div",{className:"signin-outer"},o.a.createElement("div",{className:"signin"},o.a.createElement(se.a,{size:"150px"}),o.a.createElement("h1",null,"Log in with Blockstack:"),o.a.createElement("button",{className:"signin-button",onClick:e.bind(this)},o.a.createElement(re.a,null),o.a.createElement("p",null,"Sign up/Log in"))))}}]),t}(l.Component),ce=a(176),le=(a(635),a(636),a(637),new ce.AppConfig);le.manifestPath="/caster/manifest.json",le.redirectPath="/caster",console.log("Manifest path: ".concat(le.manifestURI())),console.log("Redirect path: ".concat(le.redirectURI()));var oe=new ce.UserSession({appConfig:le});v.locale(window.navigator.userLanguage||window.navigator.language);var ue=function(e){function t(){return Object(n.a)(this,t),Object(r.a)(this,Object(i.a)(t).apply(this,arguments))}return Object(c.a)(t,e),Object(s.a)(t,[{key:"handleSignIn",value:function(e){e.preventDefault(),oe.redirectToSignIn()}},{key:"handleSignOut",value:function(e){e.preventDefault(),oe.signUserOut(window.location.origin)}},{key:"render",value:function(){return oe.isUserSignedIn()?o.a.createElement(ne,{userSession:oe,handleSignOut:this.handleSignOut}):o.a.createElement(ie,{handleSignIn:this.handleSignIn})}},{key:"componentDidMount",value:function(){var e=this;oe.isSignInPending()&&oe.handlePendingSignIn().then(function(t){window.history.replaceState({},document.title,"/"),e.setState({userData:t})})}}]),t}(l.Component);d.a.render(o.a.createElement(ue,null),document.getElementById("root"))}},[[282,1,2]]]);
//# sourceMappingURL=main.5277fcea.chunk.js.map