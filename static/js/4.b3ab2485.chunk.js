(window.webpackJsonpCaster=window.webpackJsonpCaster||[]).push([[4],{626:function(e,t){},635:function(e,t,a){},652:function(e,t,a){},653:function(e,t,a){},654:function(e,t,a){},655:function(e,t,a){},657:function(e,t,a){},663:function(e,t,a){},664:function(e,t,a){},681:function(e,t,a){"use strict";a.r(t);var n=a(559),i=a(52),r=a.n(i),s=a(560),l=a(141),c=a(142),o=a(144),u=a(143),d=a(146),p=a(145),m=a(586),h=a.n(m),f=a(2),v=a.n(f),y=a(679),g=a(680),E=a(588),k=a(665),b=a(596),w={fields:{meta:["title","description","imageURL"],episodes:["title","description","imageURL","pubDate","enclosure","duration","guid"]},required:{meta:["title","description"],episodes:[]}};function S(e,t){return O.apply(this,arguments)}function O(){return(O=Object(s.a)(r.a.mark((function e(t,a){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Requesting '".concat(a,"' via '").concat(t,"'")),n=t.endsWith("/")?t+a:"".concat(t,"/").concat(a),e.abrupt("return",Object(b.getPodcastFromURL)(n,w));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e,t,a){return e.putFile(t,JSON.stringify(a),{})}function C(e,t){return N.apply(this,arguments)}function N(){return(N=Object(s.a)(r.a.mark((function e(t,a){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getFile(a,{}).then((function(e){return e instanceof ArrayBuffer?{}:JSON.parse(e)||{}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t){return e.episode.imageURL||t[e.feedUrl].data.meta.imageURL}function R(e){var t=Math.floor(e/3600),a=Math.floor((e-3600*t)/60),n=Math.floor(e%60);return"".concat(x(t),":").concat(x(a),":").concat(x(n))}function x(e){return e.toString().padStart(2,"0")}var F=a(668),T=a(666),L=a(669),U=a(667),A=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props,t=e.audioPlayer,a=e.fallback,n=this.toggle.bind(this);return t.isLoaded()?t.isPaused()?v.a.createElement(T.a,{onClick:n}):v.a.createElement(U.a,{onClick:n}):a||null}},{key:"toggle",value:function(e){var t=this.props.audioPlayer;e.stopPropagation(),t.toggle()}}]),t}(f.Component);function V(e){var t=e.seekAmount,a=e.audioPlayer;return v.a.createElement("div",{className:"desktop-player"},v.a.createElement(F.a,{onClick:function(){return a.seekRelative(-t)}}),v.a.createElement(A,{audioPlayer:a,fallback:v.a.createElement(T.a,null)}),v.a.createElement(L.a,{onClick:function(){return a.seekRelative(+t)}}),v.a.createElement("p",null,R(a.time())),v.a.createElement("input",{className:"player-range-bar",type:"range",min:"0",value:a.time(),max:a.duration(),step:"any",onChange:function(e){return a.seekTo(e.target.value)}}),v.a.createElement("p",null,R(a.duration())))}function M(e){var t=e.audioPlayer;return v.a.createElement("div",{className:"player-bar",style:{display:t.isLoaded()?"inherit":"none"}},v.a.createElement("div",{className:"player-bar-inner"},v.a.createElement("div",{className:"player-bar-progress",style:{width:"".concat(100*t.fraction(),"%")}})))}a(635);function D(e){var t=e.feeds,a=e.openEpisode,n=e.settings,i=e.audioPlayer,r=i.getEpRef(),s=r?r.episode:null,l=s?s.title:null,c=r?t[r.feedUrl].data.meta.title:null,o=function(){return r?a(r):null};return v.a.createElement("div",{className:"player"},v.a.createElement(M,{audioPlayer:i}),v.a.createElement("div",{className:"player-image",onClick:o},r?v.a.createElement("img",{src:P(r,t),alt:""}):null),v.a.createElement("div",{className:"player-description",onClick:o},v.a.createElement("div",null,v.a.createElement("p",{className:"player-description-title"},l),v.a.createElement("p",null,c))),v.a.createElement("div",{className:"player-button"},v.a.createElement(A,{audioPlayer:i})),v.a.createElement(V,Object.assign({},e,{audioPlayer:i,seekAmount:n.seekAmount})),v.a.createElement("div",{className:"desktop-player-description"},v.a.createElement("h2",null,l),v.a.createElement("h3",null,c),v.a.createElement("p",{dangerouslySetInnerHTML:{__html:s?s.description:""}})))}var H=a(585),I=a(636),K=a(670),z=a(671),B=a(672),J=a(673),$=a(674);function _(e){var t=e.onClick,a=e.icon,n=e.text;return v.a.createElement("div",{onClick:t,className:"sidenav-item"},v.a.createElement("div",{className:"sidenav-icon"},a),v.a.createElement("p",null,n))}var q;a(652);function W(e){var t=e.open,a=e.feeds,n=e.openSettings,i=e.openHome,r=e.openFeed,s=e.openSearch,l=e.changeState,c=e.signOut;return v.a.createElement("div",{className:"menu-button"},v.a.createElement(I.slide,{isOpen:t,customBurgerIcon:v.a.createElement(K.a,null),onStateChange:function(e){return l(e.isOpen)}},v.a.createElement(_,{icon:v.a.createElement(z.a,null),text:"Home",onClick:i}),v.a.createElement(_,{icon:v.a.createElement(B.a,null),text:"Search",onClick:s}),Object.entries(a).map((function(e){var t=Object(H.a)(e,2),a=t[0],n=t[1];return v.a.createElement(_,{key:a,icon:v.a.createElement("img",{src:n.data.meta.imageURL,alt:""}),text:n.data.meta.title,onClick:function(e){e.preventDefault(),e.stopPropagation(),r(a)}})})),v.a.createElement(_,{icon:v.a.createElement(J.a,null),text:"Settings",onClick:n}),v.a.createElement(_,{icon:v.a.createElement($.a,null),text:"Sign Out",onClick:c})))}!function(e){e.Feeds="Feeds",e.Settings="Settings",e.Viewing="Viewing",e.Search="Search"}(q||(q={}));var G={corsProxy:"https://caster-cors-proxy.herokuapp.com",toggle:"p",seekBackwards:",",seekForwards:".",seekAmount:5};a(653);function Q(e){var t=e.epRef,a=e.feeds;return v.a.createElement("div",{className:"episode-view"},v.a.createElement("h1",null,t.episode.title),v.a.createElement("h2",null,a[t.feedUrl].data.meta.title),v.a.createElement("img",{src:P(t,a),alt:""}),v.a.createElement("p",{dangerouslySetInnerHTML:{__html:t.episode.description}}),v.a.createElement(X,e))}function X(e){var t=e.epRef,a=e.audioPlayer,n=e.settings,i=a.getEpRef()===t,r=n.seekAmount;return i?v.a.createElement("div",{className:"episode-player"},v.a.createElement("p",null,R(a.time())),v.a.createElement(F.a,{onClick:function(){return a.seekRelative(-r)},size:"32px"}),v.a.createElement(Y,e),v.a.createElement(L.a,{onClick:function(){return a.seekRelative(+r)},size:"32px"}),v.a.createElement("p",null,R(a.duration()))):v.a.createElement("div",{className:"episode-player"},v.a.createElement(F.a,{size:"32px"}),v.a.createElement(Y,e),v.a.createElement(L.a,{size:"32px"}))}function Y(e){var t=e.audioPlayer,a=e.playEpisode,n=e.epRef;return t.getEpRef()===n?t.isPaused()?v.a.createElement(T.a,{onClick:function(){return t.toggle()},size:"36px"}):v.a.createElement(U.a,{onClick:function(){return t.toggle()},size:"36px"}):v.a.createElement(T.a,{onClick:function(){return a(n)},size:"36px"})}var Z=a(676),ee=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={entered:e.defaultValue||""},a.handleKey=a.handleKey.bind(Object(d.a)(a)),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.className,n=t.placeholder;return v.a.createElement("input",{type:"text",value:this.state.entered,className:a,onChange:function(t){return e.setState({entered:t.target.value})},onKeyDown:this.handleKey,placeholder:n})}},{key:"handleKey",value:function(e){if(e.stopPropagation(),"Enter"===e.key){var t=this.state.entered;t&&(this.setState({entered:""}),this.props.callback(t))}}}]),t}(f.Component),te=a(675),ae=a(93),ne=a.n(ae);a(654);function ie(e){var t=e.className,a=e.onClick,n=e.image,i=e.title,r=e.body,s=e.icons;return v.a.createElement("div",{className:"item ".concat(t),onClick:a},v.a.createElement("div",{className:"item-image"},v.a.createElement("img",{src:n,alt:""})),v.a.createElement("div",{className:"item-inner"},v.a.createElement("h2",null,i),r),v.a.createElement("div",{className:"item-icons"},s))}function re(e){var t=e.feeds,a=e.url,n=e.openFeed,i=e.deleteFeed,r=t[a].data;return v.a.createElement(ie,{title:r.meta.title,image:r.meta.imageURL,body:v.a.createElement(v.a.Fragment,null,v.a.createElement("p",null,r.meta.description),v.a.createElement("p",null,r.episodes.length," episodes"),v.a.createElement("p",null,"Last refreshed ",ne()(t[a].time).fromNow())),onClick:function(){return n(a)},icons:v.a.createElement(te.a,{onClick:function(e){e.stopPropagation(),i(a)}})})}a(655);function se(e){var t=e.feeds,a=e.addFeed;return v.a.createElement(v.a.Fragment,null,Object.keys(t).map((function(t){return v.a.createElement(re,Object.assign({key:t,url:t},e))})),v.a.createElement("div",{className:"add-feed"},v.a.createElement(Z.a,null),v.a.createElement(ee,{placeholder:"Podcast Feed URL",callback:a})))}var le=a(677);function ce(e){var t=e.episode,a=e.feeds,n=e.openEpisode,i=e.playEpisode;return v.a.createElement(ie,{title:t.episode.title,image:P(t,a),body:ne()(t.episode.pubDate).format("L LT"),icons:v.a.createElement(v.a.Fragment,null,v.a.createElement(T.a,{onClick:function(){return i(t)}}),v.a.createElement(le.a,{onClick:function(){return n(t)}})),className:"episode"})}var oe=function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.feeds,n=t.feedUrl;return a[n].data.episodes.map((function(t){return v.a.createElement(ce,Object.assign({key:t.guid,episode:{episode:t,feedUrl:n}},e.props))}))}}]),t}(f.PureComponent),ue=a(656),de=a.n(ue),pe=(a(657),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={searchTerm:""},a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props.feeds,a=Object.keys(t).flatMap((function(e){return t[e].data.episodes.map((function(t){return{ref:{episode:t,feedUrl:e},episodeTitle:t.title,episodeDescription:t.description}}))})),n=de.a.go(this.state.searchTerm,a,{limit:50,keys:["episodeTitle","episodeDescription"],threshold:-500}).map((function(t){return v.a.createElement(ce,Object.assign({key:t.obj.ref.episode.guid,episode:t.obj.ref},e.props))}));return v.a.createElement("div",{className:"search"},v.a.createElement("div",{className:"search-body"},n.length?n:v.a.createElement("h1",null,"No Search Term Entered")),v.a.createElement("div",{className:"search-input"},v.a.createElement(B.a,null),v.a.createElement("input",{type:"text",placeholder:"Search Term",onChange:function(t){return e.setState({searchTerm:t.target.value})},value:this.state.searchTerm})))}}]),t}(f.PureComponent)),me=a(678),he=a(658),fe=a.n(he),ve=(a(663),function(e){function t(){return Object(l.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.settings,n=t.updateSettings,i=a.corsProxy,r=a.toggle,s=a.seekBackwards,l=a.seekForwards;return v.a.createElement("div",{className:"settings"},v.a.createElement("p",null,"Many websites do not allow you to request RSS feeds from inside a browser, so you need to use a proxy to access them. I've set up ","https://caster-cors-proxy.herokuapp.com"," which you are totally free to use, but if you want to setup a proxy yourself you can follow ",v.a.createElement("a",{href:"https://devcenter.heroku.com/articles/getting-started-with-nodejs"},"this guide")," with the ",v.a.createElement("a",{href:"https://caster-cors-proxy.herokuapp.com"},"CORS Anywhere"),"."),v.a.createElement("label",null,"CORS Proxy:"),v.a.createElement("input",{type:"url",pattern:"https?://.*",value:i,onChange:function(t){return e.updateProxy(t.target.value)},style:ge(fe()(i))}),v.a.createElement("label",null,"Pause/Play Toggle:"),v.a.createElement("input",{type:"text",value:r,style:ge(ye(r)[1]),onChange:function(t){return e.updateCharacter("toggle",t.target.value)}}),v.a.createElement("label",null,"Seek Backwards:"),v.a.createElement("input",{type:"text",value:s,style:ge(ye(s)[1]),onChange:function(t){return e.updateCharacter("seekBackwards",t.target.value)}}),v.a.createElement("label",null,"Seek Forwards:"),v.a.createElement("input",{type:"text",value:l,style:ge(ye(l)[1]),onChange:function(t){return e.updateCharacter("seekForwards",t.target.value)}}),v.a.createElement("button",{type:"reset",onClick:function(){return n(G,!0)}},v.a.createElement(me.a,null),"Reset"))}},{key:"updateProxy",value:function(e){this.props.updateSettings({corsProxy:e},fe()(e))}},{key:"updateCharacter",value:function(e,t){var a=ye(t),i=Object(H.a)(a,2),r=i[0],s=i[1];this.props.updateSettings(Object(n.a)({},e,r),s)}}]),t}(f.Component));function ye(e){return e.length>0?[e[e.length-1].toLowerCase(),!0]:["",!1]}function ge(e){return{border:"1px solid ".concat(e?"green":"red")}}var Ee=function(){function e(t,a){var n=this;Object(l.a)(this,e),this.audio=void 0,this.epRef=void 0,this.timer=void 0,this.syncTimer=void 0,this.refresh=void 0,this.syncCallback=void 0,this.audio=document.createElement("audio"),this.epRef=null,this.timer=null,this.syncTimer=null,this.refresh=t,this.syncCallback=a,this.sync=this.sync.bind(this),this.audio.ondurationchange=t,navigator.mediaSession&&(navigator.mediaSession.setActionHandler("play",this.play.bind(this)),navigator.mediaSession.setActionHandler("pause",this.pause.bind(this)),navigator.mediaSession.setActionHandler("seekbackward",(function(){return n.seekRelative(-5)})),navigator.mediaSession.setActionHandler("seekforward",(function(){return n.seekRelative(5)})))}return Object(c.a)(e,[{key:"getEpRef",value:function(){return this.epRef}},{key:"loadEp",value:function(e,t,a,n){if(this.audio.src=e.episode.enclosure.url,this.epRef=e,this.audio.currentTime=n,a?this.playNoCallback():this.pauseNoCallback(),navigator.mediaSession){var i=t[e.feedUrl].data.meta;navigator.mediaSession.metadata=new MediaMetadata({title:e.episode.title,artist:i.title,artwork:[{src:P(e,t)}]})}this.refresh()}},{key:"isLoaded",value:function(){return null!==this.getEpRef()}},{key:"isPaused",value:function(){return this.audio.paused}},{key:"isPlaying",value:function(){return!this.audio.paused}},{key:"toggle",value:function(){this.audio.paused?this.play():this.pause()}},{key:"sync",value:function(){null!==this.epRef&&this.syncCallback({epRef:this.epRef,time:this.time()})}},{key:"playNoCallback",value:function(){this.audio.play(),navigator.mediaSession&&(navigator.mediaSession.playbackState="playing"),this.timer=window.setInterval(this.refresh,100),this.syncTimer=window.setInterval(this.sync,3e4)}},{key:"pauseNoCallback",value:function(){this.audio.pause(),navigator.mediaSession&&(navigator.mediaSession.playbackState="paused"),null!==this.timer&&(window.clearInterval(this.timer),this.timer=null),null!==this.syncTimer&&(window.clearInterval(this.syncTimer),this.syncTimer=null)}},{key:"play",value:function(){this.playNoCallback(),this.refresh()}},{key:"pause",value:function(){this.pauseNoCallback(),this.refresh(),this.sync()}},{key:"time",value:function(){return this.audio.currentTime}},{key:"fraction",value:function(){return this.time()/this.duration()}},{key:"duration",value:function(){return this.audio.duration||0}},{key:"seekTo",value:function(e){this.audio.currentTime=e,this.refresh()}},{key:"seekRelative",value:function(e){this.seekTo(this.audio.currentTime+e)}}]),e}();a(664);a.d(t,"default",(function(){return ke}));var ke=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).saveTimer=null,a.audioPlayer=void 0,a.state={feeds:{},settings:G,view:q.Feeds,viewing:void 0,sidenavOpen:!1},a.refresh=a.refresh.bind(Object(d.a)(a)),a.addFeed=a.addFeed.bind(Object(d.a)(a)),a.openEpisode=a.openEpisode.bind(Object(d.a)(a)),a.playEpisode=a.playEpisode.bind(Object(d.a)(a)),a.deleteFeed=a.deleteFeed.bind(Object(d.a)(a)),a.updateSettings=a.updateSettings.bind(Object(d.a)(a)),a.sync=a.sync.bind(Object(d.a)(a)),a.audioPlayer=new Ee((function(){return a.setState({})}),(function(e){return a.savePlaying(e)})),a}return Object(p.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this;return v.a.createElement(k.a,{keyName:"*",onKeyDown:function(t,a,n){return e.handleKey(a.key)}},v.a.createElement("div",{className:"dashboard"},v.a.createElement("div",{className:"titlebar"},v.a.createElement(W,{open:this.state.sidenavOpen,feeds:this.state.feeds,openHome:function(){return e.setState({view:q.Feeds,sidenavOpen:!1})},openFeed:function(t){return e.setState({view:q.Viewing,viewing:t,sidenavOpen:!1})},openSettings:function(){return e.setState({view:q.Settings,sidenavOpen:!1})},openSearch:function(){return e.setState({view:q.Search,sidenavOpen:!1})},changeState:function(t){return e.setState({sidenavOpen:t})},signOut:this.props.signOut}),v.a.createElement("div",{className:"title"},v.a.createElement(E.Textfit,null,v.a.createElement("p",{className:"title-text"},this.title()))),v.a.createElement("div",{className:"resync-button",title:"Redownload podcast data"},v.a.createElement(y.a,{onClick:this.sync})),v.a.createElement("div",{className:"refresh-button",title:"Refresh the feeds"},v.a.createElement(g.a,{onClick:this.refresh}))),v.a.createElement("div",{className:"main"},this.inner()),v.a.createElement(D,Object.assign({},this.state,this))))}},{key:"handleKey",value:function(e){var t=this.state.settings,a=t.toggle,n=t.seekBackwards,i=t.seekForwards,r=t.seekAmount;e===a&&this.audioPlayer.toggle(),e===n&&this.audioPlayer.seekRelative(-r),e===i&&this.audioPlayer.seekRelative(+r)}},{key:"updateSettings",value:function(e,t){var a=this;this.setState({settings:h()(this.state.settings,{$merge:e})},(function(){return t?a.saveSettings():null}))}},{key:"title",value:function(){var e=this.state,t=e.view,a=e.viewing,n=e.feeds;return t===q.Feeds?"Podcasts":t===q.Settings?"Settings":t===q.Search?"Search":t===q.Viewing?"string"===typeof a?n[a].data.meta.title:"undefined"!==typeof a?a.episode.title:(console.error("View set to viewing but this.state.viewing is undefined"),""):(console.log("View ".concat(t," not handled in title()")),"")}},{key:"inner",value:function(){var e=this,t=this.state,a=t.feeds,n=t.view,i=t.viewing,r=t.settings;if(n===q.Feeds)return v.a.createElement(se,Object.assign({feeds:a,openFeed:function(t){return e.setState({viewing:t,view:q.Viewing})}},this));if(n===q.Settings)return v.a.createElement(ve,{settings:r,updateSettings:this.updateSettings});if(n===q.Viewing){if("string"===typeof i)return v.a.createElement(oe,Object.assign({feeds:a},this,{feedUrl:i}));if("undefined"!==typeof i)return v.a.createElement(Q,Object.assign({epRef:i},this.state,this));var s="View set to viewing but this.state.viewing is undefined";return console.error(s),v.a.createElement("p",null,s)}if(n===q.Search)return v.a.createElement(pe,Object.assign({feeds:a},this));var l="View ".concat(n," not handled in inner()");return console.error(l),v.a.createElement("p",null,l)}},{key:"playEpisode",value:function(e){var t=this.state.feeds;this.audioPlayer.loadEp(e,t,!0,0)}},{key:"refresh",value:function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.keys(this.state.feeds).map(this.addFeed));case 2:this.saveFeeds();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteFeed",value:function(e){var t=h()(this.state.feeds,{$unset:[e]});this.setState({feeds:t},this.saveFeeds)}},{key:"openEpisode",value:function(e){this.setState({viewing:e,view:q.Viewing})}},{key:"clearFeeds",value:function(){this.setState({feeds:{}},this.saveFeeds)}},{key:"addFeed",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var a=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S(this.state.settings.corsProxy,t).then((function(e){var i=h()(a.state.feeds,{$merge:Object(n.a)({},t,{time:Date.now(),data:e})});return a.setState({feeds:i})})).then((function(){return a.saveFeeds()})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveFeeds",value:function(){j(this.props.userSession,"feeds.json",this.state.feeds)}},{key:"saveSettings",value:function(){j(this.props.userSession,"settings.json",this.state.settings)}},{key:"savePlaying",value:function(e){j(this.props.userSession,"playing.json",e)}},{key:"sync",value:function(){var e=this,t=this.props.userSession;C(t,"feeds.json").then((function(t){return e.setState({feeds:t})})).then((function(){return C(t,"playing.json")})).then((function(t){if(t){var a=e.state.feeds;e.audioPlayer.loadEp(t.epRef,a,!1,t.time)}})),C(t,"settings.json").then((function(t){return e.setState({settings:h()(e.state.settings,{$merge:t})})}))}},{key:"componentDidMount",value:function(){this.sync()}}]),t}(f.Component)}}]);
//# sourceMappingURL=4.b3ab2485.chunk.js.map