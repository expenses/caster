(window.webpackJsonpCaster=window.webpackJsonpCaster||[]).push([[4],{627:function(e,t){},636:function(e,t,n){},653:function(e,t,n){},654:function(e,t,n){},655:function(e,t,n){},656:function(e,t,n){},658:function(e,t,n){},664:function(e,t,n){},665:function(e,t,n){},681:function(e,t,n){"use strict";n.r(t);var a=n(559),i=n(52),r=n.n(i),s=n(560),l=n(141),o=n(142),c=n(144),u=n(143),p=n(146),d=n(145),m=n(586),f=n.n(m),h=n(2),y=n.n(h),g=n(679),v=n(680),E=n(588),b=n(666),k=n(596),O=n.n(k),j=n(597),w={fields:{meta:["title","description","imageURL"],episodes:["title","description","imageURL","pubDate","enclosure","duration","guid"]},required:{meta:["title","description"],episodes:[]}};function S(e,t){return C.apply(this,arguments)}function C(){return(C=Object(s.a)(r.a.mark((function e(t,n){var a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Requesting '".concat(n,"' via '").concat(t,"'")),a=t.endsWith("/")?t+n:"".concat(t,"/").concat(n),e.abrupt("return",Object(j.getPodcastFromURL)(a,w));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function P(e,t,n){return e.putFile(t,JSON.stringify(n),{})}function F(e,t){return N.apply(this,arguments)}function N(){return(N=Object(s.a)(r.a.mark((function e(t,n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.getFile(n,{}).then((function(e){return e instanceof ArrayBuffer?{}:JSON.parse(e)||{}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e,t){return e.episode.imageURL||t[e.feedUrl].data.meta.imageURL}function R(e){var t=Math.floor(e/3600),n=Math.floor((e-3600*t)/60),a=Math.floor(e%60);return"".concat(D(t),":").concat(D(n),":").concat(D(a))}function D(e){return e.toString().padStart(2,"0")}var T=n(669),L=n(667),U=n(670),V=n(668),A=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.playing,a=t.fallback;return n?n.paused?y.a.createElement(L.a,{onClick:function(t){return e.setPaused(t,!1)}}):y.a.createElement(V.a,{onClick:function(t){return e.setPaused(t,!0)}}):a||null}},{key:"setPaused",value:function(e,t){var n=this.props.updatePlaying;e.stopPropagation(),n({paused:t})}}]),t}(h.Component);function K(e){var t=e.playing,n=e.duration,a=e.seek,i=e.updatePlaying,r=e.seekAmount,s=t?t.time:0;return y.a.createElement("div",{className:"desktop-player"},y.a.createElement(T.a,{onClick:function(){return a(-r)}}),y.a.createElement(A,{playing:t,updatePlaying:i,fallback:y.a.createElement(L.a,null)}),y.a.createElement(U.a,{onClick:function(){return a(+r)}}),y.a.createElement("p",null,R(s)),y.a.createElement("input",{className:"player-range-bar",type:"range",min:"0",value:s,max:n||0,step:"any",onChange:function(e){return i({time:e.target.value})}}),y.a.createElement("p",null,R(n||0)))}function M(e){var t=e.time,n=e.duration,a=0;n&&(a=100*(t/n));return y.a.createElement("div",{className:"player-bar",style:{display:n?"inherit":"none"}},y.a.createElement("div",{className:"player-bar-inner"},y.a.createElement("div",{className:"player-bar-progress",style:{width:"".concat(a,"%")}})))}n(636);var z=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.playing,n=e.feeds,a=e.updatePlaying,i=e.duration,r=e.endPlaying,s=e.openEpisode,l=e.setDuration,o=e.settings,c=!t||t.paused,u=t?t.epRef:null,p=u?u.episode:null,d=t?t.time:0,m=p?p.title:null,f=u?n[u.feedUrl].data.meta.title:null;return y.a.createElement("div",{className:"player",onClick:function(){return u?s(u):null}},y.a.createElement(M,{time:d,duration:i}),y.a.createElement("div",{className:"player-image"},u?y.a.createElement("img",{src:x(u,this.props.feeds),alt:""}):null),y.a.createElement("div",{className:"player-description"},y.a.createElement("div",null,y.a.createElement("p",{className:"player-description-title"},m),y.a.createElement("p",null,f))),y.a.createElement("div",{className:"player-button"},y.a.createElement(A,{playing:t,updatePlaying:a})),y.a.createElement(K,{playing:t,duration:i,seek:this.seek,updatePlaying:a,seekAmount:o.seekAmount}),y.a.createElement("div",{className:"desktop-player-description"},y.a.createElement("h2",null,m),y.a.createElement("h3",null,f),y.a.createElement("p",{dangerouslySetInnerHTML:{__html:p?p.description:""}})),y.a.createElement(O.a,{time:d,playing:!c,src:p?p.enclosure.url:void 0,listenInterval:100,onListen:function(e){return a({time:e})},onLoad:function(e){return l(e.duration)},onEnded:r,title:m||void 0}))}},{key:"seek",value:function(e){var t=this.props,n=t.playing,a=t.updatePlaying;n&&a({time:n.time+e})}}]),t}(h.Component),B=n(585),I=n(637),H=n(671),$=n(672),J=n(673),_=n(674),q=n(675);function W(e){var t=e.onClick,n=e.icon,a=e.text;return y.a.createElement("div",{onClick:t,className:"sidenav-item"},y.a.createElement("div",{className:"sidenav-icon"},n),y.a.createElement("p",null,a))}var G;n(653);function Q(e){var t=e.open,n=e.feeds,a=e.openSettings,i=e.openHome,r=e.openFeed,s=e.openSearch,l=e.changeState,o=e.signOut;return y.a.createElement("div",{className:"menu-button"},y.a.createElement(I.slide,{isOpen:t,customBurgerIcon:y.a.createElement(H.a,null),onStateChange:function(e){return l(e.isOpen)}},y.a.createElement(W,{icon:y.a.createElement($.a,null),text:"Home",onClick:i}),y.a.createElement(W,{icon:y.a.createElement(J.a,null),text:"Search",onClick:s}),Object.entries(n).map((function(e){var t=Object(B.a)(e,2),n=t[0],a=t[1];return y.a.createElement(W,{key:n,icon:y.a.createElement("img",{src:a.data.meta.imageURL,alt:""}),text:a.data.meta.title,onClick:function(e){e.preventDefault(),e.stopPropagation(),r(n)}})})),y.a.createElement(W,{icon:y.a.createElement(_.a,null),text:"Settings",onClick:a}),y.a.createElement(W,{icon:y.a.createElement(q.a,null),text:"Sign Out",onClick:o})))}!function(e){e.Feeds="Feeds",e.Settings="Settings",e.Viewing="Viewing",e.Search="Search"}(G||(G={}));var X={corsProxy:"https://caster-cors-proxy.herokuapp.com",toggle:"p",seekBackwards:",",seekForwards:".",seekAmount:5},Y=(n(654),function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.epRef,n=e.feeds;return y.a.createElement("div",{className:"episode-view"},y.a.createElement("h1",null,t.episode.title),y.a.createElement("h2",null,n[t.feedUrl].data.meta.title),y.a.createElement("img",{src:x(t,n),alt:""}),y.a.createElement("p",{dangerouslySetInnerHTML:{__html:t.episode.description}}),this.player())}},{key:"player",value:function(){var e=this.props,t=e.epRef,n=e.updatePlaying,a=e.playingDuration,i=!!this.props.playing&&this.props.playing.epRef===t,r=this.props.settings.seekAmount;if(void 0!==this.props.playing&&i){var s=this.props.playing;return y.a.createElement("div",{className:"episode-player"},y.a.createElement("p",null,R(s.time)),y.a.createElement(T.a,{onClick:function(){return n({time:s.time-r})},size:"32px"}),this.button(),y.a.createElement(U.a,{onClick:function(){return n({time:s.time+r})},size:"32px"}),y.a.createElement("p",null,R(a||0)))}return y.a.createElement("div",{className:"episode-player"},y.a.createElement(T.a,{size:"32px"}),this.button(),y.a.createElement(U.a,{size:"32px"}))}},{key:"button",value:function(){var e=this.props,t=e.playing,n=e.updatePlaying,a=e.playEpisode,i=e.epRef;return void 0!==t&&t.epRef===i?t.paused?y.a.createElement(L.a,{onClick:function(){return n({paused:!1})},size:"36px"}):y.a.createElement(V.a,{onClick:function(){return n({paused:!0})},size:"36px"}):y.a.createElement(L.a,{onClick:function(){return a(i)},size:"36px"})}}]),t}(h.Component)),Z=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={entered:e.defaultValue||""},n.handleKey=n.handleKey.bind(Object(p.a)(n)),n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return y.a.createElement("input",{type:"text",value:this.state.entered,className:this.props.className,onChange:function(t){return e.setState({entered:t.target.value})},onKeyDown:this.handleKey,placeholder:this.props.placeholder})}},{key:"handleKey",value:function(e){if(e.stopPropagation(),"Enter"===e.key){var t=this.state.entered;t&&(this.setState({entered:""}),this.props.callback(t))}}}]),t}(h.Component),ee=n(676),te=n(93),ne=n.n(te);n(655);function ae(e){var t=e.className,n=e.onClick,a=e.image,i=e.title,r=e.body,s=e.icons;return y.a.createElement("div",{className:"item ".concat(t),onClick:n},y.a.createElement("div",{className:"item-image"},y.a.createElement("img",{src:a,alt:""})),y.a.createElement("div",{className:"item-inner"},y.a.createElement("h2",null,i),r),y.a.createElement("div",{className:"item-icons"},s))}function ie(e){var t=e.feeds,n=e.url,a=e.openFeed,i=e.deleteFeed,r=t[n].data;return y.a.createElement(ae,{title:r.meta.title,image:r.meta.imageURL,body:y.a.createElement(y.a.Fragment,null,y.a.createElement("p",null,r.meta.description),y.a.createElement("p",null,r.episodes.length," episodes"),y.a.createElement("p",null,"Last refreshed ",ne()(t[n].time).fromNow())),onClick:function(){return a(n)},icons:y.a.createElement(ee.a,{onClick:function(e){e.stopPropagation(),i(n)}})})}n(656);function re(e){var t=e.feeds,n=e.openFeed,a=e.addFeed,i=e.deleteFeed;return y.a.createElement(y.a.Fragment,null,Object.keys(t).map((function(e){return y.a.createElement(ie,{key:e,url:e,feeds:t,openFeed:n,deleteFeed:i})})),y.a.createElement("div",{className:"add-feed"},y.a.createElement(Z,{placeholder:"Podcast Feed URL",callback:a})))}var se=n(677);function le(e){var t=e.episode,n=e.feeds,a=e.openEpisode,i=e.playEpisode;return y.a.createElement(ae,{title:t.episode.title,image:x(t,n),body:ne()(t.episode.pubDate).format("L LT"),icons:y.a.createElement(y.a.Fragment,null,y.a.createElement(L.a,{onClick:function(){return i(t)}}),y.a.createElement(se.a,{onClick:function(){return a(t)}})),className:"episode"})}var oe=function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.feeds,n=e.feedUrl,a=e.openEpisode,i=e.playEpisode;return t[n].data.episodes.map((function(e){return y.a.createElement(le,{key:e.guid,episode:{episode:e,feedUrl:n},feeds:t,openEpisode:a,playEpisode:i})}))}}]),t}(h.PureComponent),ce=n(657),ue=n.n(ce),pe=(n(658),function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).state={searchTerm:""},n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props.feeds,n=Object.keys(t).flatMap((function(e){return t[e].data.episodes.map((function(t){return{ref:{episode:t,feedUrl:e},episodeTitle:t.title,episodeDescription:t.description}}))})),a=ue.a.go(this.state.searchTerm,n,{limit:50,keys:["episodeTitle","episodeDescription"],threshold:-500}).map((function(n){return y.a.createElement(le,{key:n.obj.ref.episode.guid,episode:n.obj.ref,feeds:t,openEpisode:e.props.openEpisode,playEpisode:e.props.playEpisode})}));return y.a.createElement("div",{className:"search"},y.a.createElement("div",{className:"search-body"},a.length?a:y.a.createElement("h1",null,"No Search Term Entered")),y.a.createElement("div",{className:"search-input"},y.a.createElement(J.a,null),y.a.createElement("input",{type:"text",placeholder:"Search Term",onChange:function(t){return e.setState({searchTerm:t.target.value})},value:this.state.searchTerm})))}}]),t}(h.PureComponent)),de=n(678),me=n(659),fe=n.n(me),he=(n(664),function(e){function t(){return Object(l.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.settings,a=t.updateSettings,i=n.corsProxy,r=n.toggle,s=n.seekBackwards,l=n.seekForwards;return y.a.createElement("div",{className:"settings"},y.a.createElement("p",null,"Many websites do not allow you to request RSS feeds from inside a browser, so you need to use a proxy to access them. I've set up ","https://caster-cors-proxy.herokuapp.com"," which you are totally free to use, but if you want to setup a proxy yourself you can follow ",y.a.createElement("a",{href:"https://devcenter.heroku.com/articles/getting-started-with-nodejs"},"this guide")," with the ",y.a.createElement("a",{href:"https://caster-cors-proxy.herokuapp.com"},"CORS Anywhere"),"."),y.a.createElement("label",null,"CORS Proxy:"),y.a.createElement("input",{type:"url",pattern:"https?://.*",value:i,onChange:function(t){return e.updateProxy(t.target.value)},style:ge(fe()(i))}),y.a.createElement("label",null,"Pause/Play Toggle:"),y.a.createElement("input",{type:"text",value:r,style:ge(ye(r)[1]),onChange:function(t){return e.updateCharacter("toggle",t.target.value)}}),y.a.createElement("label",null,"Seek Backwards:"),y.a.createElement("input",{type:"text",value:s,style:ge(ye(s)[1]),onChange:function(t){return e.updateCharacter("seekBackwards",t.target.value)}}),y.a.createElement("label",null,"Seek Forwards:"),y.a.createElement("input",{type:"text",value:l,style:ge(ye(l)[1]),onChange:function(t){return e.updateCharacter("seekForwards",t.target.value)}}),y.a.createElement("button",{type:"reset",onClick:function(){return a(X,!0)}},y.a.createElement(de.a,null),"Reset"))}},{key:"updateProxy",value:function(e){this.props.updateSettings({corsProxy:e},fe()(e))}},{key:"updateCharacter",value:function(e,t){var n=ye(t),i=Object(B.a)(n,2),r=i[0],s=i[1];this.props.updateSettings(Object(a.a)({},e,r),s)}}]),t}(h.Component));function ye(e){return e.length>0?[e[e.length-1].toLowerCase(),!0]:["",!1]}function ge(e){return{border:"1px solid ".concat(e?"green":"red")}}n(665);n.d(t,"default",(function(){return ve}));var ve=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(c.a)(this,Object(u.a)(t).call(this,e))).saveTimer=null,n.state={feeds:{},settings:X,view:G.Feeds,playing:void 0,playingDuration:void 0,viewing:void 0,sidenavOpen:!1},n.refresh=n.refresh.bind(Object(p.a)(n)),n.addFeed=n.addFeed.bind(Object(p.a)(n)),n.openEpisode=n.openEpisode.bind(Object(p.a)(n)),n.playEpisode=n.playEpisode.bind(Object(p.a)(n)),n.updatePlaying=n.updatePlaying.bind(Object(p.a)(n)),n.deleteFeed=n.deleteFeed.bind(Object(p.a)(n)),n.updateSettings=n.updateSettings.bind(Object(p.a)(n)),n.savePlaying=n.savePlaying.bind(Object(p.a)(n)),n}return Object(d.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this;return y.a.createElement(b.a,{keyName:"*",onKeyDown:function(t,n,a){return e.handleKey(n.key)}},y.a.createElement("div",{className:"dashboard"},y.a.createElement("div",{className:"titlebar"},y.a.createElement(Q,{open:this.state.sidenavOpen,feeds:this.state.feeds,openHome:function(){return e.setState({view:G.Feeds,sidenavOpen:!1})},openFeed:function(t){return e.setState({view:G.Viewing,viewing:t,sidenavOpen:!1})},openSettings:function(){return e.setState({view:G.Settings,sidenavOpen:!1})},openSearch:function(){return e.setState({view:G.Search,sidenavOpen:!1})},changeState:function(t){return e.setState({sidenavOpen:t})},signOut:this.props.signOut}),y.a.createElement("div",{className:"title"},y.a.createElement(E.Textfit,null,y.a.createElement("p",{className:"title-text"},this.title()))),y.a.createElement("div",{className:"resync-button",title:"Redownload podcast data"},y.a.createElement(g.a,{onClick:this.sync})),y.a.createElement("div",{className:"refresh-button",title:"Refresh the feeds"},y.a.createElement(v.a,{onClick:this.refresh}))),y.a.createElement("div",{className:"main"},this.inner()),y.a.createElement(z,{playing:this.state.playing,feeds:this.state.feeds,duration:this.state.playingDuration,updatePlaying:this.updatePlaying,settings:this.state.settings,setDuration:function(t){return e.setState({playingDuration:t})},endPlaying:function(){return e.updatePlaying({paused:!0})},openEpisode:this.openEpisode})))}},{key:"handleKey",value:function(e){var t=this.state,n=t.playing,a=t.settings,i=a.toggle,r=a.seekBackwards,s=a.seekForwards,l=a.seekAmount;n&&(e===i&&this.updatePlaying({paused:!n.paused}),e===r&&this.updatePlaying({time:n.time-l}),e===s&&this.updatePlaying({time:n.time+l}))}},{key:"componentDidUpdate",value:function(e,t){var n=function(e){return e.playing&&!e.playing.paused};!n(t)&&n(this.state)&&(this.savePlaying(),this.saveTimer=setInterval(this.savePlaying,6e4)),n(t)&&!n(this.state)&&(this.saveTimer&&(clearInterval(this.saveTimer),this.saveTimer=null),this.savePlaying())}},{key:"updateSettings",value:function(e,t){var n=this;this.setState({settings:f()(this.state.settings,{$merge:e})},(function(){return t?n.saveSettings():null}))}},{key:"updatePlaying",value:function(e){void 0!==this.state.playing&&this.setState({playing:f()(this.state.playing,{$merge:e})})}},{key:"title",value:function(){var e=this.state,t=e.view,n=e.viewing,a=e.feeds;return t===G.Feeds?"Podcasts":t===G.Settings?"Settings":t===G.Search?"Search":t===G.Viewing?"string"===typeof n?a[n].data.meta.title:"undefined"!==typeof n?n.episode.title:(console.error("View set to viewing but this.state.viewing is undefined"),""):(console.log("View ".concat(t," not handled in title()")),"")}},{key:"inner",value:function(){var e=this,t=this.state,n=t.feeds,a=t.view,i=t.playing,r=t.viewing,s=t.settings;if(a===G.Feeds)return y.a.createElement(re,{feeds:n,openFeed:function(t){return e.setState({viewing:t,view:G.Viewing})},addFeed:this.addFeed,deleteFeed:this.deleteFeed});if(a===G.Settings)return y.a.createElement(he,{settings:s,updateSettings:this.updateSettings});if(a===G.Viewing){if("string"===typeof r)return y.a.createElement(oe,{feedUrl:r,feeds:n,openEpisode:this.openEpisode,playEpisode:this.playEpisode});if("undefined"!==typeof r)return y.a.createElement(Y,{epRef:r,feeds:n,playEpisode:this.playEpisode,playing:i,playingDuration:this.state.playingDuration,updatePlaying:this.updatePlaying,settings:s});var l="View set to viewing but this.state.viewing is undefined";return console.error(l),y.a.createElement("p",null,l)}if(a===G.Search)return y.a.createElement(pe,{feeds:this.state.feeds,openEpisode:this.openEpisode,playEpisode:this.playEpisode});var o="View ".concat(a," not handled in inner()");return console.error(o),y.a.createElement("p",null,o)}},{key:"playEpisode",value:function(e){this.setState({playing:{epRef:e,time:0,paused:!1}})}},{key:"refresh",value:function(){var e=Object(s.a)(r.a.mark((function e(){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(Object.keys(this.state.feeds).map(this.addFeed));case 2:this.saveFeeds();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"deleteFeed",value:function(e){var t=f()(this.state.feeds,{$unset:[e]});this.setState({feeds:t},this.saveFeeds)}},{key:"openEpisode",value:function(e){this.setState({viewing:e,view:G.Viewing})}},{key:"clearFeeds",value:function(){this.setState({feeds:{}},this.saveFeeds)}},{key:"addFeed",value:function(){var e=Object(s.a)(r.a.mark((function e(t){var n=this;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",S(this.state.settings.corsProxy,t).then((function(e){var i=f()(n.state.feeds,{$merge:Object(a.a)({},t,{time:Date.now(),data:e})});return n.setState({feeds:i})})).then((function(){return n.saveFeeds()})));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"saveFeeds",value:function(){P(this.props.userSession,"feeds.json",this.state.feeds)}},{key:"saveSettings",value:function(){P(this.props.userSession,"settings.json",this.state.settings)}},{key:"savePlaying",value:function(){P(this.props.userSession,"playing.json",this.state.playing)}},{key:"sync",value:function(){var e=this,t=this.props.userSession;F(t,"feeds.json").then((function(t){return e.setState({feeds:t})})).then((function(){return F(t,"playing.json")})).then((function(t){return e.setState({playing:t})})),F(t,"settings.json").then((function(t){return e.setState({settings:f()(e.state.settings,{$merge:t})})}))}},{key:"componentDidMount",value:function(){this.sync()}}]),t}(h.Component)}}]);
//# sourceMappingURL=4.a56cbec2.chunk.js.map